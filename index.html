<!-- 搜尋"加入卡片"，手動設定卡片檔案-->
<!-- 搜尋"allowedDomains"，加入external link 白名單 -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chia-Hung Kuo | Portfolio</title>
    
    <!-- External Dependencies for markdown and code highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.5/purify.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    
    <style>
        /* === Reusable Inline Link Style === */
        :root {
            --inline-link-underline-color: #3e7002;
            --inline-link-hover-bg: #f0f0f0;
            --inline-link-hover-color: #222;
        }
        html[data-theme="dark"] {
            --inline-link-underline-color: #f0f2a9;
            --inline-link-hover-bg: #333333;
            --inline-link-hover-color: #fff;
        }
        .inline-link {
            color: inherit;
            text-decoration: none;
            border-bottom: 0.5px solid var(--inline-link-underline-color);
            cursor: pointer;
            transition: color 0.2s, background 0.2s, border-bottom-color 0.2s;
            font-weight: 500;
        }
        .inline-link:hover, .inline-link:focus {
            background: var(--inline-link-hover-bg);
            color: var(--inline-link-hover-color);
            border-bottom-color: var(--inline-link-underline-color);
            font-weight: 600;
            outline: none;
        }
        /* Typography and Base Styles */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Theme Variables - Light theme default */
        :root {
            --bg-primary: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            --bg-secondary: linear-gradient(135deg, #f8f9fa 0%, #f1f3f4 100%);
            --bg-tertiary: linear-gradient(135deg, #ffffff 0%, #f5f6f7 100%);
            --text-primary: #1a1a1a;
            --text-secondary: #4a4a4a;
            --text-tertiary: #6a6a6a;
            --border-subtle: #e5e5e5;
            --accent-primary: #2c2c2c;
            --shadow-soft: rgba(0, 0, 0, 0.04);
            --shadow-medium: rgba(0, 0, 0, 0.08);
            --shadow-strong: rgba(0, 0, 0, 0.12);
        }

        /* Auto Dark Theme - matches system preference */
        @media (prefers-color-scheme: dark) {
            :root:not([data-theme="light"]) {
                --bg-primary: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
                --bg-secondary: linear-gradient(135deg, #151515 0%, #252525 100%);
                --bg-tertiary: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
                --text-primary: #ffffff;
                --text-secondary: #e0e0e0;
                --text-tertiary: #b0b0b0;
                --border-subtle: #333333;
                --accent-primary: #ffffff;
                --shadow-soft: rgba(255, 255, 255, 0.02);
                --shadow-medium: rgba(255, 255, 255, 0.04);
                --shadow-strong: rgba(255, 255, 255, 0.06);
            }
        }

        /* Manual Dark Theme Override */
        html[data-theme="dark"] {
            --bg-primary: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
            --bg-secondary: linear-gradient(135deg, #151515 0%, #252525 100%);
            --bg-tertiary: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
            --text-primary: #ffffff;
            --text-secondary: #e0e0e0;
            --text-tertiary: #b0b0b0;
            --border-subtle: #333333;
            --accent-primary: #ffffff;
            --shadow-soft: rgba(255, 255, 255, 0.02);
            --shadow-medium: rgba(255, 255, 255, 0.04);
            --shadow-strong: rgba(255, 255, 255, 0.06);
        }

        /* Body styles with gradient background */
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            color: var(--text-primary);
            background: linear-gradient(to bottom, #e6f3ff 0%, #f5f5dc 100%);
            min-height: 100vh;
            transition: all 0.4s ease;
            padding-bottom: 2rem;
        }

        /* Dark theme background override */
        html[data-theme="dark"] body {
            background: linear-gradient(to bottom, #1a202c 0%, #000000 100%);
        }

        /* Container for max-width and centering */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* Theme Toggle Button - Fixed position top right */
        .theme-toggle {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            width: 2.5rem;
            height: 2.5rem;
            background: var(--bg-secondary);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 0 3px 12px var(--shadow-medium);
        }

        .theme-toggle:hover {
            transform: scale(1.08);
        }

        /* Header Section */
        .header {
            padding: 3rem 0 1.5rem 0;
            text-align: center;
            margin-bottom: 0.5rem;
        }

        .header h1 {
            font-size: clamp(2.5rem, 8vw, 4.5rem);
            font-weight: 300;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .header .subtitle {
            font-size: clamp(1.1rem, 3vw, 1.4rem);
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .header .description {
            font-size: clamp(0.95rem, 2.5vw, 1.1rem);
            color: var(--text-tertiary);
        }

        /* Main Content Container */
        .main-content {
            position: relative;
            margin-bottom: 1.5rem;
        }

        /* Content Area with integrated navigation */
        .content-area {
            background: var(--bg-secondary);
            border-radius: 1.5rem;
            padding: 5rem 2rem 2rem 2rem;
            min-height: 22rem;
            box-shadow: 0 8px 25px var(--shadow-medium);
            position: relative;
        }

        /* Navigation Container - positioned inside content area */
        .nav-container {
            position: absolute;
            top: 0rem;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            width: calc(100% - 1rem);
        }

        /* Navigation Tabs - floating bar design */
        .nav-tabs {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.5rem 2rem;
            background: var(--bg-tertiary);
            border-radius: 1.5rem;
            box-shadow: 0 4px 15px var(--shadow-soft);
            transition: all 0.3s ease;
        }

        /* Hover effect for entire nav bar */
        .nav-tabs:hover {
            transform: translateY(-2px);
        }

        /* Individual Navigation Tab */
        .nav-tab {
            background: transparent;
            border-radius: 1rem;
            padding: 0.3rem 0.8rem;
            cursor: pointer;
            transition: all 0.4s ease;
            font-size: 0.75rem;
            color: var(--text-secondary);
            transform: scale(0.9);
            opacity: 0.8;
        }

        .nav-tab:hover {
            transform: scale(0.95);
            opacity: 1;
            background: var(--bg-secondary);
        }

        /* Active nav tab styling */
        .nav-tab.active {
            background: var(--bg-secondary);
            color: var(--text-primary);
            transform: scale(1.15);
            opacity: 1;
            font-weight: 500;
            box-shadow: 0 4px 12px var(--shadow-medium);
        }

        /* Content Panels Container */
        .content-panels {
            position: relative;
            z-index: 1;
        }

        /* Individual Content Panel */
        .content-panel {
            display: none;
        }

        .content-panel.active {
            display: block;
        }

        .content-panel h2 {
            font-size: 1.6rem;
            font-weight: 500;
            margin-bottom: 1.2rem;
            color: var(--text-primary);
            text-align: center;
        }

        /* Card Grid Layout */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }

        /* Card Base Styling */
        .card {
            background: var(--bg-tertiary);
            border-radius: 1rem;
            padding: 1.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow: 0 4px 15px var(--shadow-soft);
            position: relative;
            outline: none;
        }

        .card:hover,
        .card:focus {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px var(--shadow-medium);
        }

        .card:focus {
            outline: 2px solid var(--accent-primary);
            outline-offset: 2px;
        }

        /* Card Image/Visual Element */
        .card-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 0.75rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 500;
        }

        .card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 0.75rem;
        }

        /* Card Content Elements */
        .card-label {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border-subtle);
            padding: 0.3rem 0.8rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 500;
            display: inline-block;
            margin-bottom: 1rem;
        }

        .card-status {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border-subtle);
            padding: 0.3rem 0.8rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 500;
            display: inline-block;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.8rem;
        }

        .card-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 1.2rem;
            line-height: 1.5;
        }

        .card-coauthors {
            color: var(--text-tertiary);
            font-size: 0.85rem;
            margin-bottom: 1rem;
            font-style: italic;
        }

        .card-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .tag {
            background: var(--bg-secondary);
            color: var(--text-tertiary);
            padding: 0.25rem 0.6rem;
            border-radius: 0.8rem;
            font-size: 0.7rem;
            font-weight: 500;
        }

        /* Personal card special icon */
        .personal-icon {
            font-size: 3rem;
            text-align: center;
            margin-bottom: 1rem;
            opacity: 0.8;
        }

        /* Modal Overlay */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            opacity: 1;
        }

        /* Modal Container with gradient background */
        .modal-container {
            background: linear-gradient(to bottom, #d9f5f9 0%, #d4f3e7 100%);
            border-radius: 2rem;
            width: 95%;
            max-width: 1600px;
            height: 90vh;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transform: translateY(30px);
            transition: transform 0.3s ease;
        }

        .modal.active .modal-container {
            transform: translateY(0);
        }

        /* Dark theme modal background */
        html[data-theme="dark"] .modal-container {
            background: linear-gradient(to bottom, #0d0b17 0%, #060217 100%);
        }

        /* Modal Header */
        .modal-header {
            padding: 2rem 2rem 1rem 2rem;
            text-align: center;
            flex-shrink: 0;
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: var(--bg-secondary);
            border: none;
            border-radius: 50%;
            width: 2.5rem;
            height: 2.5rem;
            cursor: pointer;
            font-size: 1.2rem;
            color: var(--text-secondary);
            transition: all 0.3s ease;
            box-shadow: 0 3px 12px var(--shadow-medium);
        }

        .modal-close:hover,
        .modal-close:focus {
            transform: scale(1.08);
            outline: 2px solid var(--accent-primary);
        }

        .modal-title {
            font-size: clamp(1.2rem, 3vw, 1.6rem);
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 0.3rem;
        }

        .modal-subtitle {
            font-size: clamp(0.9rem, 2vw, 1rem);
            color: var(--text-secondary);
        }

        /* Modal Main Content Area */
        .modal-main-content {
            flex: 1;
            margin: 0 2rem 2rem 2rem;
            position: relative;
            overflow: hidden;
        }

        .modal-content-area {
            background: var(--bg-secondary);
            border-radius: 1.5rem;
            height: 100%;
            box-shadow: 0 8px 25px var(--shadow-medium);
            position: relative;
            display: flex;
            flex-direction: column;
        }

        /* Modal Navigation - Same design as main nav */
        .modal-nav-container {
            position: relative;
            padding: 0.25rem 1rem 0 1rem;
            z-index: 10;
            flex-shrink: 0;
        }

        .modal-nav-tabs {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.5rem 2rem;
            background: var(--bg-tertiary);
            border-radius: 1.5rem;
            box-shadow: 0 4px 15px var(--shadow-soft);
            transition: all 0.3s ease;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .modal-nav-tabs::-webkit-scrollbar {
            display: none;
        }

        .modal-nav-tab {
            background: transparent;
            border: none;
            border-radius: 1rem;
            padding: 0.3rem 0.8rem;
            cursor: pointer;
            transition: all 0.4s ease;
            font-size: 0.75rem;
            color: var(--text-secondary);
            transform: scale(0.9);
            opacity: 0.8;
            white-space: nowrap;
            flex-shrink: 0;
            outline: none;
        }

        .modal-nav-tab:hover,
        .modal-nav-tab:focus {
            transform: scale(0.95);
            opacity: 1;
            background: var(--bg-secondary);
        }

        .modal-nav-tab.active {
            background: var(--bg-secondary);
            color: var(--text-primary);
            transform: scale(1.15);
            opacity: 1;
            font-weight: 500;
            box-shadow: 0 4px 12px var(--shadow-medium);
        }

        /* Modal Content Panels */
        .modal-content-panels {
            flex: 1;
            padding: 1rem 2rem 2rem 2rem;
            overflow-y: auto;
        }

        .modal-content-panel {
            display: none;
            animation: fadeInUp 0.4s ease;
        }

        .modal-content-panel.active {
            display: block;
        }

        .modal-content-panel h2 {
            font-size: 1.6rem;
            font-weight: 500;
            margin-bottom: 1.2rem;
            color: var(--text-primary);
            text-align: center;
        }

        .modal-content-panel h3 {
            font-size: 1.3rem;
            font-weight: 500;
            margin: 1.5rem 0 1rem 0;
            color: var(--text-primary);
        }

        .modal-content-panel p {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 1rem;
        }

        .modal-content-panel ul,
        .modal-content-panel ol {
            color: var(--text-secondary);
            line-height: 1.6;
            margin: 1rem 0;
            padding-left: 1.5rem;
        }

        .modal-content-panel blockquote {
            border-left: 3px solid var(--accent-primary);
            padding-left: 1rem;
            margin: 1rem 0;
            font-style: italic;
            color: var(--text-secondary);
        }

        /* Modal Image Styling - 60% of container */
        .modal-content-panel img {
            max-width: 60%;
            max-height: 60vh;
            width: auto;
            height: auto;
            object-fit: contain;
            display: block;
            margin: 1.5rem auto;
            border-radius: 0.5rem;
            box-shadow: 0 4px 12px var(--shadow-medium);
            transition: transform 0.2s ease;
        }

        .modal-content-panel img:hover {
            transform: scale(1.05);
            cursor: pointer;
        }

        /* Code Block Styling */
        .code-block {
            background: #1e1e1e;
            color: #e0e0e0;
            padding: 1.5rem;
            border-radius: 0.75rem;
            font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
            font-size: 0.85rem;
            overflow-x: auto;
            margin: 1rem 0;
            position: relative;
        }

        .copy-button {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: var(--bg-tertiary);
            border: none;
            border-radius: 0.5rem;
            padding: 0.5rem;
            cursor: pointer;
            font-size: 0.7rem;
            color: var(--text-primary);
            transition: all 0.2s ease;
        }

        .copy-button:hover {
            background: var(--bg-secondary);
            transform: scale(1.05);
        }

        /* iFrame Container */
        .iframe-container {
            width: 100%;
            height: 65vh;
            border-radius: 0.75rem;
            overflow: hidden;
            margin: 1rem 0;
            border: 1px solid var(--border-subtle);
        }

        .iframe-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .action-button {
            background: var(--accent-primary);
            color: var(--bg-primary);
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .action-button:hover,
        .action-button:focus {
            background: var(--text-primary);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px var(--shadow-medium);
        }

        /* External Link Button - Theme-specific styling */
        .external-link-button {
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 12px var(--shadow-medium);
            border: 1px solid #1a1a1a;
        }

        /* Light mode: 白底黑字 */
        html:not([data-theme="dark"]) .external-link-button {
            background: #ffffff;
            color: #1a1a1a;
            border-color: #1a1a1a;
        }

        html:not([data-theme="dark"]) .external-link-button:hover,
        html:not([data-theme="dark"]) .external-link-button:focus {
            background: #1a1a1a;
            color: #ffffff;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px var(--shadow-strong);
            outline: none;
        }

        /* Dark mode: 黑底白字 */
        html[data-theme="dark"] .external-link-button {
            background: #1a1a1a;
            color: #ffffff;
            border-color: #ffffff;
        }

        html[data-theme="dark"] .external-link-button:hover,
        html[data-theme="dark"] .external-link-button:focus {
            background: #ffffff;
            color: #1a1a1a;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px var(--shadow-strong);
            outline: none;
        }

        /* Auto dark mode (系統偏好設定) */
        @media (prefers-color-scheme: dark) {
            html:not([data-theme="light"]) .external-link-button {
                background: #1a1a1a;
                color: #ffffff;
                border-color: #ffffff;
            }

            html:not([data-theme="light"]) .external-link-button:hover,
            html:not([data-theme="light"]) .external-link-button:focus {
                background: #ffffff;
                color: #1a1a1a;
                transform: translateY(-2px);
                box-shadow: 0 6px 20px var(--shadow-strong);
                outline: none;
            }
        }

        /* Placeholder Content for empty sections */
        .placeholder-content {
            padding: 1.5rem;
            text-align: center;
            color: var(--text-tertiary);
            min-height: 12rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.6rem;
        }

        .placeholder-icon {
            font-size: 2.2rem;
            margin-bottom: 0.6rem;
            opacity: 0.6;
        }

        /* Footer - Fixed at bottom */
        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            padding: 0.5rem 1rem;
            z-index: 100;
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.7rem;
            color: var(--text-tertiary);
            opacity: 0.6;
        }

        .footer-links {
            display: flex;
            gap: 1rem;
        }

        .footer-links span {
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .footer-links span:hover {
            color: var(--text-secondary);
            opacity: 1;
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(15px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Focus trap utilities */
        .focus-trap {
            position: fixed;
            top: 0;
            left: 0;
            width: 1px;
            height: 1px;
            opacity: 0;
            pointer-events: none;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-tabs {
                overflow-x: auto;
                justify-content: flex-start;
            }
            .nav-tab {
                flex-shrink: 0;
            }
            .card-grid {
                grid-template-columns: 1fr;
            }
            .modal-container {
                width: 95%;
                height: 90vh;
            }
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Theme Toggle Button -->
        <div class="theme-toggle" onclick="toggleTheme()" tabindex="0" role="button" aria-label="Toggle theme">
            <span id="theme-icon">○</span>
        </div>

        <!-- Header Section -->
        <div class="header">
            <h1>Chia-Hung Kuo</h1>
            <p class="subtitle">Data Science | ML | Economics</p>
            <p class="description">Building data-driven solutions with economic insight</p>
        </div>

        <!-- Main Content Container -->
        <div class="main-content">
            <div class="content-area">
                <!-- Navigation positioned inside content area -->
                <div class="nav-container">
                    <div class="nav-tabs">
                        <div class="nav-tab active" onclick="showContent('about')">About</div>
                        <!-- <div class="nav-tab" onclick="showContent('tech')">Tech Stack</div> -->
                        <div class="nav-tab" onclick="showContent('projects')">Portfolio</div>
                        <!-- <div class="nav-tab" onclick="showContent('personal')">Personal</div> -->
                        <div class="nav-tab" onclick="showContent('contact')">Contact</div>
                    </div>
                </div>

                <!-- Content Panels -->
                <div class="content-panel active" id="about-panel">

                <div style="display: flex; justify-content: center; align-items: center; margin-bottom: 1.5rem; width: 100%;">
                    <img src="asset/figure/about/avatar.JPG" alt="Chia-Hung Kuo" style="max-width: 400px; height: auto; border-radius: 8px; display: block;">
                </div>

                <div class="placeholder-content" style="text-align: left; align-items: flex-start;">

                    <p>
                    I'm Chia-Hung Kuo, an PhD candidate turned data scientist based in Seattle, specializing in quantitative analysis and machine learning. You can view my <a href="asset/doc/cv_kuo.pdf" target="_blank" rel="noopener noreferrer" class="inline-link">CV</a> here.
                    </p>

                    <p>
                    With advanced doctoral training in Economics from Michigan State University, I bring rigorous analytical skills and deep understanding of statistical methods to data science. 
                    My economics background provides unique expertise in causal inference, econometric modeling, and experimental design — skills directly applicable to A/B testing, predictive modeling, and business analytics.
                    </p>

        

                    <h4 style="margin-top:1em;">Technical Skills</h4>
                    <ul style="list-style: none; padding-left: 0; font-size: 0.9rem; opacity: 0.85; line-height: 1.6;">
                    <li> • Programming: Python, SQL, Stata, Julia, R, MATLAB</li>
                    <li> • Libraries & Tools: pandas, NumPy, Polars, scikit-learn, PyTorch, matplotlib, seaborn</li>
                    <li> • Data Tools: PostgreSQL, BigQuery, Redshift, Spark (PySpark)</li>
                    <li> • Cloud & DevOps: AWS, Docker, Git, FastAPI, Flask</li>
                    <li> • Core Skills: data visualization, supervised & unsupervised learning, A/B testing & experimentation, deep learning, MLOps, time-series modeling, causal inference</li>
                    </ul>

                </div>
                </div>

                    <!-- Tech Stack Panel
                    <div class="content-panel" id="tech-panel">
                        <h2>Tech Stack <div class="placeholder-icon">🛠️</div></h2>
                        <div class="placeholder-content">
                            
                            <p>Expandable categories</p>
                            <p style="font-size: 0.9rem; opacity: 0.7;">Languages • Data Science • Machine Learning • Economics</p>
                        </div>
                    </div> -->

                    <!-- Projects Panel - Dynamic content loaded from cards -->
                    <div class="content-panel" id="projects-panel">
                        <h2></h2>
                        <div class="card-grid" id="projects-grid"></div>
                    </div>




                    <!-- Personal Panel - Dynamic content loaded from cards -->
                    <div class="content-panel" id="personal-panel">
                        <h2></h2>
                        <div class="card-grid" id="personal-grid"></div>
                    </div>

                    <!-- Contact Panel -->
                    <div class="content-panel" id="contact-panel">
                        <h2></h2>
                        <div class="placeholder-content">
                            <p style="font-size: 1rem; margin-bottom: 1rem;">
                                <strong>Seeking:</strong> Data Scientist roles in the Greater Seattle area or remote<br>
                                
                            </p>
                            <p style="font-size: 0.9rem; opacity: 0.7;">
                                <a href="https://github.com/kuochh" target="_blank" rel="noopener noreferrer" class="inline-link">GitHub</a> •
                                <a href="https://linkedin.com/in/chia-hung-kuo" target="_blank" rel="noopener noreferrer" class="inline-link">LinkedIn</a> •
                                <a href="mailto:kuo.chiahung@icloud.com" class="inline-link">Email</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Universal Modal -->
    <div class="modal" id="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
        <div class="modal-container">
            <div class="modal-header">
                <button class="modal-close" onclick="closeModal()" aria-label="Close modal">×</button>
                <h1 class="modal-title" id="modal-title">Title Placeholder</h1>
                <p class="modal-subtitle" id="modal-subtitle">Subtitle Placeholder</p>
            </div>
            
            <div class="modal-main-content">
                <div class="modal-content-area">
                    <div class="modal-nav-container">
                        <div class="modal-nav-tabs" id="modal-nav-tabs" role="tablist">
                            <!-- Tabs will be dynamically generated -->
                        </div>
                    </div>
                    
                    <div class="modal-content-panels" id="modal-content-panels">
                        <!-- Content panels will be dynamically generated -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Focus trap elements for accessibility -->
    <div class="focus-trap" tabindex="0" id="focus-trap-start"></div>
    <div class="focus-trap" tabindex="0" id="focus-trap-end"></div>

    <!-- Fixed Footer -->
    <div class="footer">
        <div class="footer-content">
            <div class="footer-links">
                <span>© 2025 Chia-Hung Kuo</span>
            </div>
        </div>
    </div>

    <script>
        // ==============================================
        // GLOBAL VARIABLES & CONFIGURATION
        // ==============================================
        
        // System configuration
        const CONFIG = {
            allowedDomains: ['kuochh.github.io', 'observablehq.com', 'nbviewer.org', 'youtube.com', 'youtu.be'],
            allowedTags: ['p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'ul', 'ol', 'li', 'a', 'strong', 'em', 'code', 'pre', 'blockquote', 'img', 'br', 'hr', 'div', 'span'],
            allowedAttributes: ['href', 'target', 'rel', 'src', 'alt', 'title', 'class'],
            showCopyButton: true,
            syntaxHighlight: true
        };

        // Global data storage for dynamically loaded cards
        window.PortfolioCards = window.PortfolioCards || [];
        let portfolioData = {
            projects: [],
            papers: [],
            dataViz: [],
            personal: []
        };

        // Modal state management
        let currentFocusedElement = null;
        let modalFocusableElements = [];

        // ==============================================
        // UTILITY FUNCTIONS
        // ==============================================
        
        // FIXED: Validates card data structure - now checks the correct fields
        function validateCard(item) {
            if (!item || typeof item !== 'object') {
                console.log('Card validation failed: item is not an object', item);
                return false;
            }
            if (!item.id || typeof item.id !== 'string' || !item.id.trim()) {
                console.log('Card validation failed: missing or invalid id', item);
                return false;
            }
            if (!item.title || typeof item.title !== 'string' || !item.title.trim()) {
                console.log('Card validation failed: missing or invalid title', item);
                return false;
            }
            
            // Validate modal tabs if they exist
            if (item.modal && item.modal.tabs) {
                if (!Array.isArray(item.modal.tabs)) {
                    console.log('Card validation failed: modal.tabs is not an array', item);
                    return false;
                }
                for (const tab of item.modal.tabs) {
                    if (!tab.id || !tab.title || !tab.content || !tab.content.type) {
                        console.log('Card validation failed: invalid tab structure', tab);
                        return false;
                    }
                    const validTypes = ['text', 'link', 'github', 'html', 'markdown', 'iframe', 'code'];
                    if (!validTypes.includes(tab.content.type)) {
                        console.log('Card validation failed: invalid content type', tab.content.type);
                        return false;
                    }
                }
            }
            
            return true;
        }

        // Sanitizes HTML content to prevent XSS
        function sanitizeHTML(html) {
            if (typeof DOMPurify !== 'undefined') {
                return DOMPurify.sanitize(html, {
                    ALLOWED_TAGS: CONFIG.allowedTags,
                    ALLOWED_ATTR: CONFIG.allowedAttributes
                });
            }
            
            // Fallback sanitization if DOMPurify not available
            let sanitized = html;
            sanitized = sanitized.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, '');
            sanitized = sanitized.replace(/\s*on\w+\s*=\s*"[^"]*"/gi, '');
            sanitized = sanitized.replace(/\s*on\w+\s*=\s*'[^']*'/gi, '');
            sanitized = sanitized.replace(/href\s*=\s*["']javascript:[^"']*["']/gi, 'href="#"');
            return sanitized;
        }

        // Parses markdown to HTML
        function parseMarkdown(md) {
            if (typeof marked !== 'undefined') {
                return marked.parse(md);
            }
            
            // Basic fallback markdown parsing
            let html = md;
            html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');
            html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');
            html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');
            html = html.replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>');
            html = html.replace(/\*([^*]+)\*/g, '<em>$1</em>');
            html = html.replace(/`([^`]+)`/g, '<code>$1</code>');
            html = html.replace(/^\- (.+$)/gim, '<li>$1</li>');
            html = html.replace(/(<li>.*<\/li>)/s, '<ul>$1</ul>');
            html = html.replace(/\n\n/g, '</p><p>');
            html = '<p>' + html + '</p>';
            return html;
        }

        // Validates URL against allowed domains
        function isAllowedDomain(url) {
            try {
                const urlObj = new URL(url);
                return CONFIG.allowedDomains.some(domain => 
                    urlObj.hostname === domain || urlObj.hostname.endsWith('.' + domain)
                );
            } catch {
                return false;
            }
        }

        // Copies text to clipboard
        async function copyToClipboard(text) {
            try {
                if (navigator.clipboard) {
                    await navigator.clipboard.writeText(text);
                } else {
                    const textArea = document.createElement('textarea');
                    textArea.value = text;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                }
                console.log('Code copied to clipboard');
            } catch (err) {
                console.error('Failed to copy text: ', err);
            }
        }

        // ==============================================
        // CARD CREATION & RENDERING
        // ==============================================
        
        // Creates HTML for individual card
        function createCard(item, variant = 'default') {
            if (!validateCard(item)) {
                console.warn(`Invalid card data for item:`, item);
                return '';
            }

            let html = `<div class="card" data-id="${item.id}" data-variant="${variant}" tabindex="0" role="button" aria-label="Open ${item.title}">`;

            // Image handling
            if (item.image_url) {
                html += `<div class="card-image">
                    <img src="${item.image_url}" alt="${item.title}" loading="lazy" 
                         onerror="this.parentElement.innerHTML='<div style=\\'display:flex;align-items:center;justify-content:center;height:100%;color:white;\\'>📊<br>Image Placeholder</div>'">
                </div>`;
            } else if (variant === 'viz') {
                html += `<div class="card-image">📊<br>Image Placeholder</div>`;
            }

            // Personal project icon
            if (variant === 'personal' && item.icon) {
                html += `<div class="personal-icon">${item.icon}</div>`;
            }

            // Date label
            if (item.date) {
                html += `<div class="card-label">${item.date}</div>`;
            }

            // Status indicator
            if (item.status) {
                const statusClass = item.status.toLowerCase().replace(/\s+/g, '-');
                html += `<div class="card-status ${statusClass}">${item.status}</div>`;
            }

            // Required title
            html += `<div class="card-title">${item.title}</div>`;

            // Optional description
            if (item.description) {
                html += `<div class="card-description">${item.description}</div>`;
            }

            // Co-authors for papers
            if (item.coauthors && Array.isArray(item.coauthors) && item.coauthors.length > 0) {
                html += `<div class="card-coauthors">By ${item.coauthors.join(', ')}</div>`;
            }

            // Tags
            if (item.tags && Array.isArray(item.tags) && item.tags.length > 0) {
                html += `<div class="card-tags">`;
                item.tags.forEach(tag => {
                    html += `<span class="tag">${tag}</span>`;
                });
                html += `</div>`;
            }

            html += `</div>`;
            return html;
        }

        // Renders grid of cards with event delegation
        function renderGrid(containerId, items, variant, onCardClick) {
            const container = document.getElementById(containerId);
            if (!container) {
                console.warn(`Container with id '${containerId}' not found`);
                return;
            }

            // Filter valid items
            const validItems = items.filter(item => {
                const isValid = validateCard(item);
                if (!isValid) {
                    console.warn(`Skipping invalid card:`, item);
                }
                return isValid;
            });

            // Generate HTML for all cards
            const cardsHTML = validItems.map(item => createCard(item, variant)).join('');
            container.innerHTML = cardsHTML;

            // Event delegation for performance
            container.removeEventListener('click', handleCardInteraction);
            container.removeEventListener('keydown', handleCardKeyboard);
            
            container.addEventListener('click', handleCardInteraction);
            container.addEventListener('keydown', handleCardKeyboard);

            function handleCardInteraction(event) {
                const card = event.target.closest('.card');
                if (card) {
                    const itemId = card.dataset.id;
                    const itemVariant = card.dataset.variant;
                    if (itemId && onCardClick) {
                        onCardClick(itemVariant, itemId);
                    }
                }
            }

            function handleCardKeyboard(event) {
                if (event.key === 'Enter' || event.key === ' ') {
                    event.preventDefault();
                    handleCardInteraction(event);
                }
            }
        }

        // ==============================================
        // MODAL FUNCTIONALITY
        // ==============================================

        // Renders content for modal tabs
        function renderTabContent(tab) {
            const content = tab.content;
            let html = '';

            switch (content.type) {
                case 'text':
                    html += `<div class="text-content"><p>${content.text || 'No text content provided.'}</p></div>`;
                    break;

                case 'html':
                    const sanitizedHTML = sanitizeHTML(content.html || '');
                    html += `<div class="html-content">${sanitizedHTML}</div>`;
                    break;

                case 'markdown':
                    const markdownHTML = parseMarkdown(content.md || '');
                    const sanitizedMarkdown = sanitizeHTML(markdownHTML);
                    html += `<div class="markdown-content">${sanitizedMarkdown}</div>`;
                    break;

                case 'code':
                    const language = content.language || 'javascript';
                    const codeId = `code-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
                    const code = content.code || '// No code provided';
                    html += `<div class="code-container">
                        <div class="code-block">
                            ${CONFIG.showCopyButton ? `<button class="copy-button" onclick="copyToClipboard(document.getElementById('${codeId}').textContent)">Copy</button>` : ''}
                            <pre><code id="${codeId}" class="language-${language}">${code}</code></pre>
                        </div>
                    </div>`;
                    break;

                case 'iframe':
                    if (content.url && isAllowedDomain(content.url)) {
                        html += `<div class="iframe-container">
                            <iframe src="${content.url}" 
                                    loading="lazy" 
                                    referrerpolicy="no-referrer"
                                    title="${tab.title}">
                            </iframe>
                        </div>`;
                    } else {
                        html += `<div class="error-content">
                            <p>⚠️ This content cannot be displayed due to security restrictions.</p>
                            <p>URL: ${content.url || 'No URL provided'}</p>
                        </div>`;
                    }
                    break;

                case 'link':
                    html += `<div class="link-content">
                        ${content.description ? `<p>${content.description}</p>` : ''}
                        <div class="action-buttons">
                            <a href="${content.url || '#'}" target="_blank" rel="noopener noreferrer" class="external-link-button">
                                🔗 Open Link
                            </a>
                        </div>
                    </div>`;
                    break;

                case 'github':
                    html += `<div class="github-content">
                        ${content.description ? `<p>${content.description}</p>` : ''}
                        <div class="action-buttons">
                            <a href="${content.url || '#'}" target="_blank" rel="noopener noreferrer" class="external-link-button">
                                📂 View on GitHub
                            </a>
                        </div>
                    </div>`;
                    break;

                default:
                    html += `<div class="error-content">
                        <p>⚠️ Unsupported content type: ${content.type}</p>
                    </div>`;
            }

            return html;
        }

        // Shows specific tab in modal
        function showTab(tabId) {
            // Update tab navigation
            document.querySelectorAll('.modal-nav-tab').forEach((tab, index) => {
                const isActive = tab.dataset.tabId === tabId;
                tab.classList.toggle('active', isActive);
                tab.setAttribute('aria-selected', isActive);
            });

            // Update content panels
            document.querySelectorAll('.modal-content-panel').forEach(panel => {
                const isActive = panel.dataset.tabId === tabId;
                panel.classList.toggle('active', isActive);
                panel.setAttribute('aria-hidden', !isActive);
            });

            // Apply syntax highlighting to active panel
            if (CONFIG.syntaxHighlight && typeof Prism !== 'undefined') {
                setTimeout(() => {
                    const activePanel = document.querySelector('.modal-content-panel.active');
                    if (activePanel) {
                        const codeBlocks = activePanel.querySelectorAll('pre code');
                        codeBlocks.forEach(block => {
                            Prism.highlightElement(block);
                        });
                    }
                }, 10);
            }
        }

        // Opens modal with specific content
        function openModal(variant, id) {
            const dataCategory = variant === 'project' ? 'projects' : 
                                variant === 'paper' ? 'papers' : 
                                variant === 'viz' ? 'dataViz' : 
                                variant === 'personal' ? 'personal' : variant;
            
            const item = portfolioData[dataCategory]?.find(item => item.id === id);
            if (!item) {
                console.warn(`Item with id '${id}' not found in category '${dataCategory}'`);
                return;
            }

            // Store current focus for restoration
            currentFocusedElement = document.activeElement;

            // Set modal title and subtitle
            document.getElementById('modal-title').textContent = item.title;
            const subtitle = item.modal?.subtitle || '';
            document.getElementById('modal-subtitle').textContent = subtitle;

            // Clear existing content
            const navTabsContainer = document.getElementById('modal-nav-tabs');
            const contentPanelsContainer = document.getElementById('modal-content-panels');
            navTabsContainer.innerHTML = '';
            contentPanelsContainer.innerHTML = '';

            // Generate tabs and content
            if (item.modal && item.modal.tabs) {
                item.modal.tabs.forEach((tab, index) => {
                    // Create navigation tab
                    const navTab = document.createElement('button');
                    navTab.className = `modal-nav-tab ${index === 0 ? 'active' : ''}`;
                    navTab.textContent = tab.title;
                    navTab.dataset.tabId = tab.id;
                    navTab.setAttribute('role', 'tab');
                    navTab.setAttribute('aria-selected', index === 0);
                    navTab.setAttribute('aria-controls', `panel-${tab.id}`);
                    navTab.onclick = () => showTab(tab.id);
                    navTabsContainer.appendChild(navTab);

                    // Create content panel
                    const contentPanel = document.createElement('div');
                    contentPanel.className = `modal-content-panel ${index === 0 ? 'active' : ''}`;
                    contentPanel.dataset.tabId = tab.id;
                    contentPanel.id = `panel-${tab.id}`;
                    contentPanel.setAttribute('role', 'tabpanel');
                    contentPanel.setAttribute('aria-hidden', index !== 0);
                    contentPanel.innerHTML = renderTabContent(tab);
                    contentPanelsContainer.appendChild(contentPanel);
                });
            } else {
                // Fallback content
                navTabsContainer.innerHTML = '<div class="modal-nav-tab active">Overview</div>';
                contentPanelsContainer.innerHTML = '<div class="modal-content-panel active"><h2>Overview</h2><p>No additional content available.</p></div>';
            }

            // Show modal
            const modal = document.getElementById('modal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';

            // Focus management
            setTimeout(() => {
                const firstTab = navTabsContainer.querySelector('.modal-nav-tab');
                if (firstTab) {
                    firstTab.focus();
                }
                setupFocusTrap();
            }, 100);

            // Apply syntax highlighting
            if (CONFIG.syntaxHighlight && typeof Prism !== 'undefined') {
                setTimeout(() => {
                    Prism.highlightAll();
                }, 200);
            }

            // Make images clickable to open in new tab
            setTimeout(() => {
                const modalImages = document.querySelectorAll('.modal-content-panel img');
                modalImages.forEach(img => {
                    img.style.cursor = 'pointer';
                    img.addEventListener('click', function() {
                        window.open(this.src, '_blank');
                    });

                    // Add title attribute for accessibility
                    if (!img.title) {
                        img.title = 'Click to open full-size image in new tab';
                    }
                });
            }, 250);
        }

        // Closes modal and restores focus
        function closeModal() {
            const modal = document.getElementById('modal');
            modal.classList.remove('active');
            document.body.style.overflow = '';

            // Restore focus
            if (currentFocusedElement) {
                currentFocusedElement.focus();
                currentFocusedElement = null;
            }

            modalFocusableElements = [];
        }

        // Sets up focus trapping in modal
        function setupFocusTrap() {
            const modal = document.getElementById('modal');
            modalFocusableElements = modal.querySelectorAll(
                'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
            );
        }

        // ==============================================
        // CONTENT LOADING SYSTEM
        // ==============================================

        // 加入卡片： Loads cards from external files with better error handling
        async function loadCards() {
            // List of card files to load - add new files here (ordering matters)
            const cardFiles = [
                'cards/projects-spy-breakout.js',
                'cards/projects-migration.js',
                'cards/projects-china-education.js'
                // Add more card files here as you create them
            ];

            console.log('Loading card files:', cardFiles);

            // Load each card file
            let loadedCount = 0;
            let failedFiles = [];

            for (const file of cardFiles) {
                try {
                    const script = document.createElement('script');
                    script.src = file;
                    script.async = false; // Load in order
                    document.head.appendChild(script);

                    // Wait for script to load
                    await new Promise((resolve, reject) => {
                        script.onload = () => {
                            console.log(`✅ Loaded: ${file}`);
                            loadedCount++;
                            resolve();
                        };
                        script.onerror = () => {
                            console.warn(`⚠️ File not found or failed to load: ${file}`);
                            failedFiles.push(file);
                            resolve(); // Continue even if file fails
                        };
                    });
                } catch (error) {
                    console.warn(`⚠️ Error loading card file ${file}:`, error);
                    failedFiles.push(file);
                }
            }

            // Report loading summary
            console.log(`📊 Card loading summary: ${loadedCount}/${cardFiles.length} files loaded successfully`);
            if (failedFiles.length > 0) {
                console.warn(`⚠️ Failed to load: ${failedFiles.join(', ')}`);
                console.log('💡 Tip: Remove missing files from the cardFiles array in index.html');
            }

            console.log(`Loaded ${window.PortfolioCards ? window.PortfolioCards.length : 0} cards`);

            // FIXED: Process loaded cards with better validation and logging
            if (window.PortfolioCards && Array.isArray(window.PortfolioCards)) {
                window.PortfolioCards.forEach((card, index) => {
                    console.log(`Processing card ${index + 1}:`, card);
                    
                    // Check if category exists and is valid
                    if (!card.category) {
                        console.warn(`Card ${index + 1} missing category:`, card);
                        return;
                    }
                    
                    if (!portfolioData[card.category]) {
                        console.warn(`Card ${index + 1} has unknown category '${card.category}':`, card);
                        return;
                    }
                    
                    // Validate the card data
                    if (!card.data) {
                        console.warn(`Card ${index + 1} missing data object:`, card);
                        return;
                    }
                    
                    if (!validateCard(card.data)) {
                        console.warn(`Card ${index + 1} failed validation:`, card);
                        return;
                    }
                    
                    // Add valid card to appropriate category
                    portfolioData[card.category].push(card.data);
                    console.log(`Successfully added card '${card.data.title}' to category '${card.category}'`);
                });
            } else {
                console.warn('No PortfolioCards found or not an array');
            }

            // Log final counts
            console.log('Final portfolio data:', {
                projects: portfolioData.projects.length,
                papers: portfolioData.papers.length,
                dataViz: portfolioData.dataViz.length,
                personal: portfolioData.personal.length
            });

            // Initialize grids with loaded data
            initializeGrids();
        }

        // Initializes all content grids
        function initializeGrids() {
            console.log('Initializing grids...');
            renderGrid('projects-grid', portfolioData.projects, 'project', openModal);
            renderGrid('papers-grid', portfolioData.papers, 'paper', openModal);
            renderGrid('viz-grid', portfolioData.dataViz, 'viz', openModal);
            renderGrid('personal-grid', portfolioData.personal, 'personal', openModal);
            console.log('Grids initialized');
        }

        // ==============================================
        // NAVIGATION & UI CONTROLS
        // ==============================================

        // Toggles between light and dark themes
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            const themeIcon = document.getElementById('theme-icon');
            
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            if (themeIcon) {
                themeIcon.textContent = newTheme === 'dark' ? '●' : '○';
            }
        }

        // Shows specific content panel
        function showContent(panelId) {
            // Hide all panels
            document.querySelectorAll('.content-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected panel
            const targetPanel = document.getElementById(panelId + '-panel');
            if (targetPanel) {
                targetPanel.classList.add('active');
            }
            
            // Add active class to clicked tab
            if (event && event.target) {
                event.target.classList.add('active');
            }
        }

        // Initializes theme based on user preference
        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme');
            const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
            const theme = savedTheme || systemTheme;
            const themeIcon = document.getElementById('theme-icon');
            
            document.documentElement.setAttribute('data-theme', theme);
            if (themeIcon) {
                themeIcon.textContent = theme === 'dark' ? '●' : '○';
            }
        }

        // ==============================================
        // EVENT LISTENERS
        // ==============================================

        // Global keyboard event handling
        document.addEventListener('keydown', function(event) {
            const modal = document.getElementById('modal');
            
            // Escape key closes modal
            if (event.key === 'Escape' && modal.classList.contains('active')) {
                event.preventDefault();
                closeModal();
                return;
            }
            
            // Tab key for focus trapping in modal
            if (event.key === 'Tab' && modal.classList.contains('active')) {
                if (modalFocusableElements.length === 0) return;
                
                const firstElement = modalFocusableElements[0];
                const lastElement = modalFocusableElements[modalFocusableElements.length - 1];
                
                if (event.shiftKey) {
                    if (document.activeElement === firstElement) {
                        event.preventDefault();
                        lastElement.focus();
                    }
                } else {
                    if (document.activeElement === lastElement) {
                        event.preventDefault();
                        firstElement.focus();
                    }
                }
            }
            
            // Theme toggle keyboard support
            if (event.target.classList.contains('theme-toggle') && (event.key === 'Enter' || event.key === ' ')) {
                event.preventDefault();
                toggleTheme();
            }
        });

        // Click outside modal to close
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('modal');
            if (event.target === modal) {
                closeModal();
            }
        });

        // Window resize handling
        let resizeTimeout;
        window.addEventListener('resize', function() {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                const modal = document.getElementById('modal');
                if (modal.classList.contains('active')) {
                    setupFocusTrap();
                }
            }, 250);
        });

        // ==============================================
        // INITIALIZATION
        // ==============================================

        // Main initialization function
        async function initialize() {
            console.log('Portfolio system initializing...');
            
            // Initialize theme
            initializeTheme();
            
            // Load and render cards
            await loadCards();
            
            console.log('Portfolio system initialized successfully');
        }

        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initialize);
        } else {
            initialize();
        }

        // ==============================================
        // GLOBAL API
        // ==============================================

        // Expose functions globally for debugging/external use
        window.PortfolioSystem = {
            createCard,
            renderGrid,
            openModal,
            closeModal,
            showTab,
            validateCard,
            getData: () => portfolioData,
            getConfig: () => CONFIG,
            reloadCards: loadCards
        };
    </script>
</body>
</html>